.page-vulnerabilities-cve(ng-if='!loading')
  section.vulnerability-details-header
    page-header(title="{{:: cve.id}}", subtitle="pageHeaderSubtitle")
    aside.page-header-aside.icon-inline.severity(ng-class="{{'cve.impact'}}")
      i.fa.fa-shield
      span {{:: cve.impact}}
    .description
      h2.section-title.section-title-red Description
      span {{:: cve.description}}

  .vulnerability-tables
    .primary
      .table-header
        .dropdown
          md-button.button-dropdown(
            data-toggle='dropdown',
            aria-haspopup='true',
            aria-expanded='false',
            aria-label='Actions Dropdown',
            translate,
            ng-disabled='!checkboxes.totalChecked || !config.isPlannerEnabled') Actions
            span.caret
          .dropdown-menu
            md-button.full-width.md-no-margin(translate) Create a new Plan/Playbook
            md-button.full-width.md-no-margin(translate) Add to existing Plan/Playbook
        .table-header-title
          h3.system-count(translate, translate-n='totalSystems', translate-plural='{{:: $count}} Impacted Systems') 1 Impacted System
          small.light(ng-if='checkboxes.totalChecked', translate) &nbsp; {{checkboxes.totalChecked}} Selected
            span(ng-if='allSelected && pager.perPage < totalSystems') .
              a(ng-if='!reallyAllSelected', ng-click='reallySelectAll()') &nbsp;Select All Systems.
              a(ng-if='reallyAllSelected', ng-click='deselectAll()') &nbsp;Deselect All Systems.
            span )
      table
        thead
          tr
            th.min
              md-checkbox.md-accent.md-hue-1.md-checkbox-list(
                tooltip='Select All',
                type="checkbox",
                aria-label='Select All Systems Checkbox',
                md-indeterminate="checkboxes.indeterminate",
                ng-model='checkboxes.checked',
                ng-change='selectAll(); checkboxes.checkboxChecked(checkboxes.checked, rhsa.systems)')
            th.min.sortable(translate) Type
            th.sortable(translate) Name
            th.min.sortable(translate) Last Check In

        tbody
          tr(ng-click='checkboxes.rowClick($event, system.system_id)',
             ng-mousedown='checkboxes.rowClick($event, system.system_id)',
             ng-class="{'stale': !system.isCheckingIn}",
             ng-repeat='system in cve.systems track by system.system_id',
             data-id="{{:: system.system_id}}")
            td.min
              md-checkbox.md-accent.md-hue-1.md-checkbox-list(
                type='checkbox',
                aria-label='Select System Checkbox',
                ng-model='checkboxes.items[system.system_id]',
                ng-click='checkboxes.rowClick($event, system.system_id); $event.stopPropagation();',
              )
            td.fit-content
              type-icon(type-id='system.system_type_id', include-text='true')
            td.break
              a(ng-click='showSystem(system)') {{:: system.toString }}
            td.fit-content {{:: system.last_check_in | timeAgo}}
    table.related-packages
        thead
          tr
            th.fit-content.nowrap.sortable Related Packages
        tbody
          tr(ng-repeat='package in cve.packages')
            td.fit-content.nowrap
              a(ui-sref='app.vulnerabilities-package({package_id: package.id})') {{:: package.name}}

  section.content-wrap
