.page-vulnerabilities-package(ng-if='!loading')
  breadcrumbs
  section.vulnerability-details-header
    page-header(title="Package: {{:: package.id}}", subtitle="pageHeaderSubtitle")
    //.page-header-aside test test
    .description
      | {{:: package.description}}
    //.description-aside test test

  table-filters
    search-box(placeholder="{{'Search RHSAs' | translate}}", on-search='search(model)')

  section.content-wrap
    // TODO make Summary Card a component
    .card-list-tiles.card-list-rhsa
      card.card-rhsa(ng-repeat='rhsa in rhsas', ng-click='indexMe($index + 1); toggleShowCVEs(rhsa)', ng-class='{active: isSelected(rhsa)}', style="order: {{$index + 1}}")
        card-content
          .icon
            i.fa.fa-shield(ng-class="{{'rhsa.severity'}}")
          strong
            a(ui-sref='app.vulnerabilities-package-rhsa({rhsa_id: rhsa.id, package_id: package.id, root_view: selectedView})',
              ng-click="$event.stopPropagation()")
              .text {{ rhsa.id }}
          .cve-count
            span {{ rhsa.cves.length }} CVEs
            .pipe |
            span.hits  {{ getAssociatedRule(rhsa) }}
              i.fa.fa-book(tooltip="{{'This RHSA has an associated Insights Rule' | translate}}")

      card.card-cve-summary(ng-show='selectedRHSA', style="order: {{cveOrder}}")
        card-content
          card.rule-hit(expandable='true', ng-if="selectedCVE.insights_rule")
            card-header-expandable
              .title.icon-inline
                i.fa.fa-book(aria-hidden='true')
                span Associated Insights Rule
            card-content.card-content(collapse="card.collapsed")
              .spinner.spinner-sm(ng-if='loadingRule')
              incident-icon(rule-id='report.rule_id', ng-if='selectedRule && !loadingRule')
              .title(ng-if='selectedRule && !loadingRule')
                a(ui-sref='app.actions-rule({category: selectedRule.category, rule: selectedRule.rule_id})')
                  |{{ selectedRule.category }} #{'>'} {{ selectedRule.description }}

          ul.cve-id
            li(ng-repeat='cve in selectedRHSA.cves', ng-click='selectCVE(cve)')
              a(ng-class='{active: cve.id === selectedCVE.id}') {{ cve.id }}
              i.fa.fa-book(ng-if='selectedCVE.insights_rule', tooltip="{{'This CVE has an associated Insights Rule' | translate}}")

          .description
            trimmed-text(length="300", text="{{selectedCVE.description}}")
            a.cve-link(href="{{selectedCVE.link}}", target="_blank") More
              i.fa.fa-external-link
            a.cve-page-redirect(ui-sref='app.vulnerabilities-package-cve({cve_id: selectedCVE.id, package_id: package.id, root_view: selectedView})')
              | Go To {{:: selectedCVE.id}} Page
          .cve-information
            .impact
              b Impact:
              |  {{ selectedCVE.impact }}
            .public-date
              b Public-Date:
              |  {{ selectedCVE.public_date }}
            .iava(ng-if='selectedCVE.iava')
              b IAVA:
              |  {{ selectedCVE.iava }}
            .cwe(ng-if='selectedCVE.cwes.length > 0')
              b CWEs:
                a(ng-repeat="cwe in selectedCVE.cwes", href="{{:: cwe.link}}", target="_blank") {{ cwe.id }}

