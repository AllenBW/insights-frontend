.page-vulnerabilities
  section
    page-header(title="Vulnerabilities", icon="fa-stethoscope")

  .table-header
    table-filters
      search-box(ng-show="selectedView === views.package", placeholder="{{'Search Packages' | translate}}",
                 on-search='search(model)')
      search-box(ng-show="selectedView === views.rhsa", placeholder="{{'Search RHSAs' | translate}}",
                 on-search='search(model)')
      search-box(ng-show="selectedView === views.cve", placeholder="{{'Search CVEs' | translate}}",
                 on-search='search(model)')

    .view-switcher.button-tabs
      b View by:
      md-button(ng-click="changeView(views.package)",
        ng-class="{active: selectedView === views.package}")
        a {{:: views.package }}
      md-button(ng-click="changeView(views.rhsa)",
        ng-class="{active: selectedView === views.rhsa}")
        a {{:: views.rhsa }}
      md-button(ng-click="changeView(views.cve)",
        ng-class="{active: selectedView === views.cve}")
        a {{:: views.cve }}

  // TODO make embedded card a component
  .content-wrap
      .vulnerabilities-package-view(ng-if="!loading && selectedView === views.package")
        table
          thead
            tr
              th.fit-content.nowrap.sortable(ng-class="sorter.getSortClass('id')", ng-click="sorter.sort('id')", translate) Package Name
              th.text-center.fit-content.min.nowrap.sortable(translate, ng-class="sorter.getSortClass('systems_affected')", ng-click="sorter.sort('systems_affected')") Systems
              th.text-center.fit-content.min.nowrap.sortable(translate, ng-class="sorter.getSortClass('rhsa_count')", ng-click="sorter.sort('rhsa_count')") RHSAs
              th.text-center.fit-content.min.nowrap.sortable(translate, ng-class="sorter.getSortClass('cve_count')", ng-click="sorter.sort('cve_count')") CVEs
              th.text-center.fit-content.min.nowrap.sortable(translate, ng-class="sorter.getSortClass('release_date')", ng-click="sorter.sort('release_date')") Release Date
          tbody
            tr(ng-repeat='vulnerability in vulnerabilities track by vulnerability.id')
              td.fit-content.nowrap
                a(ui-sref='app.vulnerabilities-package({package_id: vulnerability.id, selected_view: selectedView})') {{:: vulnerability.id}}
              td.text-center.fit-content.nowrap
                span {{:: vulnerability.systems_affected}}
              td.text-center.fit-content.nowrap
                span {{:: vulnerability.rhsa_count}}
              td.text-center.fit-content.nowrap
                span {{:: vulnerability.cve_count}}
              td.text-center.fit-content.nowrap
                span {{:: vulnerability.release_date}}
      .vulnerabilities-rhsa-view(ng-if="!loading && selectedView === views.rhsa")
        table
          thead
            tr
              th.fit-content.nowrap.sortable(translate, ng-class="sorter.getSortClass('id')", ng-click="sorter.sort('id')") RHSA Name
              th.text-center.fit-content.min.nowrap.sortable(translate, ng-class="sorter.getSortClass('systems_affected')", ng-click="sorter.sort('systems_affected')") Systems
              th.text-center.fit-content.min.nowrap.sortable(translate, ng-class="sorter.getSortClass('package_count')", ng-click="sorter.sort('package_count')") Packages
              th.text-center.fit-content.min.nowrap.sortable(translate, ng-class="sorter.getSortClass('cve_count')", ng-click="sorter.sort('cve_count')") CVEs
              th.text-center.fit-content.min.nowrap.sortable(translate, ng-class="sorter.getSortClass('issued')", ng-click="sorter.sort('issued')") Release Date
          tbody
            tr(ng-repeat='vulnerability in vulnerabilities track by vulnerability.id')
              td.fit-content.nowrap
                a(ui-sref='app.vulnerabilities-rhsa({rhsa_id: vulnerability.id, selected_view: selectedView})') {{:: vulnerability.id}}
              td.text-center.fit-content.nowrap
                span {{:: vulnerability.systems_affected}}
              td.text-center.fit-content.nowrap
                span {{:: vulnerability.package_count}}
              td.text-center.fit-content.nowrap
                span {{:: vulnerability.cve_count}}
              td.text-center.fit-content.nowrap
                span {{:: vulnerability.issued}}
      .vulnerabilities-cve-view(ng-if="!loading && selectedView === views.cve")
        table
          thead
            tr
              th.fit-content.nowrap.sortable(translate, ng-class="sorter.getSortClass('id')", ng-click="sorter.sort('id')") CVE Name
              th.text-center.fit-content.min.nowrap.sortable(translate, ng-class="sorter.getSortClass('systems_affected')", ng-click="sorter.sort('systems_affected')") Systems
              th.text-center.fit-content.min.nowrap.sortable(translate, ng-class="sorter.getSortClass('package_count')", ng-click="sorter.sort('package_count')") Packages
              th.text-center.fit-content.min.nowrap.sortable(translate, ng-class="sorter.getSortClass('public_date')", ng-click="sorter.sort('public_date')") Release Date
          tbody
            tr(ng-repeat='vulnerability in vulnerabilities track by vulnerability.id')
              td.fit-content.nowrap
                a(ui-sref='app.vulnerabilities-cve({cve_id: vulnerability.id, selected_view: selectedView})') {{:: vulnerability.id}}
              td.text-center.fit-content.nowrap
                span {{:: vulnerability.systems_affected}}
              td.text-center.fit-content.nowrap
                span {{:: vulnerability.package_count}}
              td.text-center.fit-content.nowrap
                span {{:: vulnerability.public_date}}