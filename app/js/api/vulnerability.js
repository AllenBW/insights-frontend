'use strict';

const apiModule = require('./');

// const URI = require('urijs');

/**
 * @ngInject
 */
function Vulnerability ($q, VMAAS_CVES, VMAAS_PACKAGES_NOCVE, VMAAS_RHSAS) {

    // function Policy ($http, AccountService, InsightsConfig) {

    // const vulnerabilitiesUri = 'vulnerabilities';
    // const root = InsightsConfig.apiRoot;

    return {

        // getAll (params) {
        //     let url = URI(root);
        //     url.segment(vulnerabilitiesUri);
        //     url.addSearch(AccountService.queryParam());

        //     if (params) {
        //         url.addSearch(params);
        //     }

        //     return $http.get(url.toString());
        // },

        getAll (params) {
            console.log(params);
            return $q.resolve(VMAAS_PACKAGES_NOCVE);
        },

        getCVEs () {
            return $q.resolve(VMAAS_CVES);
        },

        getRHSAs () {
            return $q.resolve(VMAAS_RHSAS);
        }
    };
}

apiModule.factory('Vulnerability', Vulnerability);
